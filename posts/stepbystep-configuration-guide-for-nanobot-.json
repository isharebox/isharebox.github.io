{"__ud_title":"step‑by‑step configuration guide for nanobot","__ud_tags":["nanobot"],"__ud_update_time":1771230415283,"__ud_create_time":1771034502388,"__ud_draft":false,"type":"doc","content":[{"type":"heading","attrs":{"level":1,"id":"stepbystep-configuration-guide-for-nanobot"},"content":[{"type":"text","text":"step‑by‑step configuration guide for "},{"type":"text","marks":[{"type":"bold"}],"text":"nanobot"}]},{"type":"paragraph","content":[{"type":"text","text":"Here’s a practical, step‑by‑step configuration guide for "},{"type":"text","marks":[{"type":"bold"}],"text":"nanobot on GitHub"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"香港大学数据科学实验室（HKUDS）的一个项目，他们把 OpenClaw 的核心能力压缩到了 3663 行 Python 代码里，砍掉了 99% 的体量，但保留了 agent loop、tool 调用、多渠道接入、定时任务、持久化记忆这些关键模块。2 月 2 号上线，两周拿下 19000+ stars。"}]},{"type":"image","attrs":{"src":"https://pica.zhimg.com/80/v2-3f1c28c4eb82b7ca4dc0d7c775747c71_720w.webp?source=2c26e567","alt":null,"title":null}},{"type":"heading","attrs":{"level":2,"id":"项目定位与背景"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"项目定位与背景"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot 解决的是给个人或小团队提供一个自托管的 AI 助手，能接 "},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://zhida.zhihu.com/search?content_id=769614043&content_type=Answer&match_order=1&q=Telegram&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NzEzNjk5MzcsInEiOiJUZWxlZ3JhbSIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjc2OTYxNDA0MywiY29udGVudF90eXBlIjoiQW5zd2VyIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.Yw9fMwwnJA7XTlDwktOKcGpGqnGs_s8nYFI67rOs8os&zhida_source=entity","target":"_blank","rel":"noopener noreferrer nofollow","class":"RichContent-EntityWord css-b7erz1"}}],"text":"Telegram"},{"type":"text","text":"、"},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://zhida.zhihu.com/search?content_id=769614043&content_type=Answer&match_order=1&q=Discord&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NzEzNjk5MzcsInEiOiJEaXNjb3JkIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6NzY5NjE0MDQzLCJjb250ZW50X3R5cGUiOiJBbnN3ZXIiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.zm-y8B_NUccIOweENgwR-Ti_Ke_GGdf5AVAE8Mfh4Xw&zhida_source=entity","target":"_blank","rel":"noopener noreferrer nofollow","class":"RichContent-EntityWord css-b7erz1"}}],"text":"Discord"},{"type":"text","text":"、"},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://zhida.zhihu.com/search?content_id=769614043&content_type=Answer&match_order=1&q=WhatsApp&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NzEzNjk5MzcsInEiOiJXaGF0c0FwcCIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjc2OTYxNDA0MywiY29udGVudF90eXBlIjoiQW5zd2VyIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.7TkdWEjlOjZy3LIXrmlWAwUHqm_0Q6QECYrohugq-kA&zhida_source=entity","target":"_blank","rel":"noopener noreferrer nofollow","class":"RichContent-EntityWord css-b7erz1"}}],"text":"WhatsApp"},{"type":"text","text":"、"},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://zhida.zhihu.com/search?content_id=769614043&content_type=Answer&match_order=1&q=%E9%A3%9E%E4%B9%A6&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NzEzNjk5MzcsInEiOiLpo57kuaYiLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjo3Njk2MTQwNDMsImNvbnRlbnRfdHlwZSI6IkFuc3dlciIsIm1hdGNoX29yZGVyIjoxLCJ6ZF90b2tlbiI6bnVsbH0.DhUCmaJ1-Tz_VEcGJOi-zrKEmOsCaOJ9FWTKPiB5S-o&zhida_source=entity","target":"_blank","rel":"noopener noreferrer nofollow","class":"RichContent-EntityWord css-b7erz1"}}],"text":"飞书"},{"type":"text","text":"、"},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://zhida.zhihu.com/search?content_id=769614043&content_type=Answer&match_order=1&q=%E9%92%89%E9%92%89&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NzEzNjk5MzcsInEiOiLpkonpkokiLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjo3Njk2MTQwNDMsImNvbnRlbnRfdHlwZSI6IkFuc3dlciIsIm1hdGNoX29yZGVyIjoxLCJ6ZF90b2tlbiI6bnVsbH0.Wca3qx-kmhL_69v71JETdkGJhoc4nHdoXmOKH-fW1pQ&zhida_source=entity","target":"_blank","rel":"noopener noreferrer nofollow","class":"RichContent-EntityWord css-b7erz1"}}],"text":"钉钉"},{"type":"text","text":"、"},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://zhida.zhihu.com/search?content_id=769614043&content_type=Answer&match_order=1&q=Slack&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NzEzNjk5MzcsInEiOiJTbGFjayIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjc2OTYxNDA0MywiY29udGVudF90eXBlIjoiQW5zd2VyIiwibWF0Y2hfb3JkZXIiOjEsInpkX3Rva2VuIjpudWxsfQ.hgWvIE7CgnG0vcldlw6lRPtJW7aRx_AQK1QAwXOWr_g&zhida_source=entity","target":"_blank","rel":"noopener noreferrer nofollow","class":"RichContent-EntityWord css-b7erz1"}}],"text":"Slack"},{"type":"text","text":"、邮件、QQ 这些渠道，背后跑一个具备工具调用能力的 agent。"}]},{"type":"paragraph","content":[{"type":"text","text":"与 OpenClaw 比较："}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"维度OpenClaw / Clawdbotnanobot"},{"type":"text","text":"代码量43 万行3663 行部署复杂度较高，依赖多pip install 即可渠道覆盖全平台9 个渠道，覆盖主流 IM二次开发门槛代码量大，模块耦合源码可读，改造成本低成熟度生产级Alpha 阶段，迭代快"}]},{"type":"paragraph","content":[{"type":"text","text":"如果你需要一个经过验证的生产级产品，OpenClaw 更适合你。如果你要一个能 fork 下来快速定制的 agent 底座，或者做 agent 相关的学术研究，nanobot 更值得你去学习。"}]},{"type":"heading","attrs":{"level":2,"id":"核心功能"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"核心功能"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"Agent Loop 与工具调用"},{"type":"text","text":"：核心循环在 "},{"type":"text","marks":[{"type":"code"}],"text":"agent/loop.py"},{"type":"text","text":"，LLM 调用和工具执行交替进行。内置 shell 执行、文件读写、目录浏览等工具，也支持通过 "},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://zhida.zhihu.com/search?content_id=769614043&content_type=Answer&match_order=1&q=MCP+%E5%8D%8F%E8%AE%AE&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NzEzNjk5MzcsInEiOiJNQ1Ag5Y2P6K6uIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6NzY5NjE0MDQzLCJjb250ZW50X3R5cGUiOiJBbnN3ZXIiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.CHob4l1WsdoFofdvoj1WGU1uE2s2tgFJFXjdAwMJrx8&zhida_source=entity","target":"_blank","rel":"noopener noreferrer nofollow","class":"RichContent-EntityWord css-b7erz1"}}],"text":"MCP 协议"},{"type":"text","text":"接入外部工具服务器。"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"多 LLM Provider 支持"},{"type":"text","text":"：通过 LiteLLM 统一路由，支持 "},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://zhida.zhihu.com/search?content_id=769614043&content_type=Answer&match_order=1&q=OpenRouter&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NzEzNjk5MzcsInEiOiJPcGVuUm91dGVyIiwiemhpZGFfc291cmNlIjoiZW50aXR5IiwiY29udGVudF9pZCI6NzY5NjE0MDQzLCJjb250ZW50X3R5cGUiOiJBbnN3ZXIiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.f0wwhDqm2Wh1TqmCVtowymKr-7u4pEMkz9d2TVwLu3I&zhida_source=entity","target":"_blank","rel":"noopener noreferrer nofollow","class":"RichContent-EntityWord css-b7erz1"}}],"text":"OpenRouter"},{"type":"text","text":"、Anthropic、OpenAI、DeepSeek、Groq、Gemini、Moonshot、智谱、MiniMax、通义千问，以及 vLLM 本地推理。新增 provider 只需改两个文件。"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"9 渠道接入"},{"type":"text","text":"：Telegram、Discord、WhatsApp、飞书、钉钉、Slack、Email、QQ、Mochat。"},{"type":"text","marks":[{"type":"code"}],"text":"nanobot gateway"},{"type":"text","text":" 一条命令启动网关，消息自动路由到 agent。"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"定时任务"},{"type":"text","text":"："},{"type":"text","marks":[{"type":"code"}],"text":"nanobot cron add"},{"type":"text","text":" 支持 cron 表达式和固定间隔，用于定期执行 agent 指令。"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"持久化记忆"},{"type":"text","text":"："},{"type":"text","marks":[{"type":"code"}],"text":"agent/memory.py"},{"type":"text","text":" 实现跨会话记忆，agent 能记住之前的交互内容。"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"MCP 协议兼容"},{"type":"text","text":"：配置格式和 Claude Desktop / Cursor 完全兼容，直接把 MCP Server 的 README 配置复制过来就能用。"}]}]}]},{"type":"image","attrs":{"src":"https://picx.zhimg.com/80/v2-cfc1d0fedb06cc104d981716adcde01d_720w.webp?source=2c26e567","alt":null,"title":null}},{"type":"paragraph","content":[{"type":"text","text":"项目结构"}]},{"type":"heading","attrs":{"level":2,"id":"部署与安装"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"部署与安装"}]},{"type":"heading","attrs":{"level":3,"id":"前置环境"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"前置环境"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","text":"Python ≥ 3.11"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","text":"Node.js ≥ 18（仅 WhatsApp 渠道需要）"}]}]},{"type":"listItem","content":[{"type":"paragraph","content":[{"type":"text","text":"至少一个 LLM API Key（推荐 OpenRouter，一个 key 可以调所有模型）"}]}]}]},{"type":"heading","attrs":{"level":3,"id":"方式一pip-安装"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"方式一：pip 安装"}]},{"type":"codeBlock","attrs":{"language":"bash"},"content":[{"type":"text","text":"pip install nanobot-ai\n​\n# 初始化配置目录\nnanobot onboard"}]},{"type":"heading","attrs":{"level":3,"id":"方式二源码安装"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"方式二：源码安装"}]},{"type":"codeBlock","attrs":{"language":"bash"},"content":[{"type":"text","text":"git clone https://github.com/HKUDS/nanobot.git\ncd nanobot\npip install -e .\nnanobot onboard"}]},{"type":"heading","attrs":{"level":3,"id":"方式三Docker-部署"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"方式三：Docker 部署"}]},{"type":"codeBlock","attrs":{"language":"bash"},"content":[{"type":"text","text":"# 构建镜像\ngit clone https://github.com/HKUDS/nanobot.git\ncd nanobot\ndocker build -t nanobot .\n​\n# 初始化配置（首次）\ndocker run -v ~/.nanobot:/root/.nanobot --rm nanobot onboard\n​\n# 编辑配置文件，填入 API Key\nvim ~/.nanobot/config.json\n​\n# 启动网关（连接已启用的聊天渠道）\ndocker run -d \\\n  -v ~/.nanobot:/root/.nanobot \\\n  -p 18790:18790 \\\n  --name nanobot \\\n  nanobot gateway"}]},{"type":"paragraph","content":[{"type":"text","text":"镜像基于 "},{"type":"text","marks":[{"type":"code"}],"text":"uv:python3.12-bookworm-slim"},{"type":"text","text":"，内置 Node.js 20 用于 WhatsApp bridge，体积控制得比较紧凑。"},{"type":"text","marks":[{"type":"code"}],"text":"-v ~/.nanobot:/root/.nanobot"},{"type":"text","text":" 这个挂载是关键，配置、workspace、记忆数据全在这个目录下，容器重启不会丢。"}]},{"type":"heading","attrs":{"level":3,"id":"安装验证"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"安装验证"}]},{"type":"codeBlock","attrs":{"language":"bash"},"content":[{"type":"text","text":"# 检查状态\nnanobot status\n​\n# 发一条消息测试 agent 是否正常响应\nnanobot agent -m \"Hello, nanobot!\"\n​\n# Docker 环境下\ndocker run -v ~/.nanobot:/root/.nanobot --rm nanobot status\ndocker run -v ~/.nanobot:/root/.nanobot --rm nanobot agent -m \"Hello!\""}]},{"type":"heading","attrs":{"level":2,"id":"配置与使用方法"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"配置与使用方法"}]},{"type":"paragraph","content":[{"type":"text","text":"所有配置集中在 "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot/config.json"},{"type":"text","text":" 一个文件里。"}]},{"type":"heading","attrs":{"level":3,"id":"Provider-配置"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"Provider 配置"}]},{"type":"paragraph","content":[{"type":"text","text":"最快的跑通路径是用 OpenRouter："}]},{"type":"codeBlock","attrs":{"language":"json"},"content":[{"type":"text","text":"{\n  \"providers\": {\n    \"openrouter\": {\n      \"apiKey\": \"sk-or-v1-xxx\"\n    }\n  },\n  \"agents\": {\n    \"defaults\": {\n      \"model\": \"anthropic/claude-opus-4-5\"\n    }\n  }\n}"}]},{"type":"paragraph","content":[{"type":"text","text":"要跑本地模型，配 vLLM 或任何 OpenAI 兼容端点："}]},{"type":"codeBlock","attrs":{"language":"json"},"content":[{"type":"text","text":"{\n  \"providers\": {\n    \"vllm\": {\n      \"apiKey\": \"dummy\",\n      \"apiBase\": \"http://localhost:8000/v1\"\n    }\n  },\n  \"agents\": {\n    \"defaults\": {\n      \"model\": \"meta-llama/Llama-3.1-8B-Instruct\"\n    }\n  }\n}"}]},{"type":"paragraph","content":[{"type":"text","text":"如果你用的 LLM 服务不在内置列表里，"},{"type":"text","marks":[{"type":"code"}],"text":"custom"},{"type":"text","text":" provider 兜底，只要对方兼容 OpenAI chat completions 接口就行："}]},{"type":"codeBlock","attrs":{"language":"json"},"content":[{"type":"text","text":"{\n  \"providers\": {\n    \"custom\": {\n      \"apiKey\": \"your-api-key\",\n      \"apiBase\": \"https://api.your-provider.com/v1\"\n    }\n  }\n}"}]},{"type":"heading","attrs":{"level":3,"id":"渠道配置"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"渠道配置"}]},{"type":"paragraph","content":[{"type":"text","text":"以 Telegram 为例，BotFather 建个 bot，拿到 token，填进去："}]},{"type":"codeBlock","attrs":{"language":"json"},"content":[{"type":"text","text":"{\n  \"channels\": {\n    \"telegram\": {\n      \"enabled\": true,\n      \"token\": \"YOUR_BOT_TOKEN\",\n      \"allowFrom\": [\"YOUR_USER_ID\"]\n    }\n  }\n}"}]},{"type":"paragraph","content":[{"type":"text","text":"然后 "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot gateway"},{"type":"text","text":" 启动网关。飞书、钉钉、Slack 都走 WebSocket 长连接，不需要公网 IP。"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"code"}],"text":"allowFrom"},{"type":"text","text":" 是白名单机制。留空表示任何人都能跟你的 bot 对话，生产环境务必填上受信用户 ID。"}]},{"type":"heading","attrs":{"level":3,"id":"MCP-工具接入"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"MCP 工具接入"}]},{"type":"codeBlock","attrs":{"language":"json"},"content":[{"type":"text","text":"{\n  \"tools\": {\n    \"mcpServers\": {\n      \"filesystem\": {\n        \"command\": \"npx\",\n        \"args\": [\"-y\", \"@modelcontextprotocol/server-filesystem\", \"/path/to/dir\"]\n      }\n    }\n  }\n}"}]},{"type":"paragraph","content":[{"type":"text","text":"支持 stdio 和 HTTP 两种传输模式。启动时自动发现并注册 MCP 工具，LLM 调用时和内置工具没有区别。"}]},{"type":"heading","attrs":{"level":3,"id":"安全配置"},"content":[{"type":"text","marks":[{"type":"bold"}],"text":"安全配置"}]},{"type":"codeBlock","attrs":{"language":"json"},"content":[{"type":"text","text":"{\n  \"tools\": {\n    \"restrictToWorkspace\": true\n  }\n}"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"code"}],"text":"restrictToWorkspace"},{"type":"text","text":" 开启后，agent 的 shell 执行、文件读写全部限制在 workspace 目录内，防止路径穿越。生产部署建议开启。"}]},{"type":"paragraph","content":[{"type":"text","text":"1. "},{"type":"text","marks":[{"type":"bold"}],"text":"HKUDS/nanobot – “Ultra‑Lightweight Personal AI Assistant” (Python, multi‑channel)"}]},{"type":"paragraph","content":[{"type":"text","text":"2. "},{"type":"text","marks":[{"type":"bold"}],"text":"nanobot-ai/nanobot – “Build MCP Agents” (Go, MCP host)"}]},{"type":"paragraph","content":[{"type":"text","text":"You can skip to the one you actually meant."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"## 0. Which “nanobot” do you mean?"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"bold"}],"text":"HKUDS/nanobot"}]},{"type":"paragraph","content":[{"type":"text","text":"- URL: "},{"type":"text","marks":[{"type":"code"}],"text":"https://github.com/HKUDS/nanobot"}]},{"type":"paragraph","content":[{"type":"text","text":"- Language: Python"}]},{"type":"paragraph","content":[{"type":"text","text":"- What it is: A personal AI assistant that can talk via "},{"type":"text","marks":[{"type":"bold"}],"text":"Telegram / Discord / WhatsApp / Slack / Email / QQ / Feishu / DingTalk / Mochat"},{"type":"text","text":" etc."}]},{"type":"paragraph","content":[{"type":"text","text":"- Config file: "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot/config.json"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"bold"}],"text":"nanobot-ai/nanobot"}]},{"type":"paragraph","content":[{"type":"text","text":"- URL: "},{"type":"text","marks":[{"type":"code"}],"text":"https://github.com/nanobot-ai/nanobot"}]},{"type":"paragraph","content":[{"type":"text","text":"- Language: Go"}]},{"type":"paragraph","content":[{"type":"text","text":"- What it is: A standalone "},{"type":"text","marks":[{"type":"bold"}],"text":"MCP host"},{"type":"text","text":" for building agents with MCP/MCP‑UI (e.g. Blackjack, Hugging Face, shopping agents)"}]},{"type":"paragraph","content":[{"type":"text","text":"- Config file: "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot.yaml"},{"type":"text","text":" or a directory of "},{"type":"text","marks":[{"type":"code"}],"text":".md"},{"type":"text","text":" agent files"}]},{"type":"paragraph","content":[{"type":"text","text":"If you’re not sure, check the repo URL. The guide below is split into "},{"type":"text","marks":[{"type":"bold"}],"text":"Part A (HKUDS)"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"bold"}],"text":"Part B (nanobot-ai)"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"heading","attrs":{"level":3,"id":"-Part-A--HKUDSnanobot-StepbyStep-Config-configjson"},"content":[{"type":"text","text":"## Part A – HKUDS/nanobot: Step‑by‑Step Config (config.json)"}]},{"type":"paragraph","content":[{"type":"text","text":"### Overview of the flow"}]},{"type":"paragraph","content":[{"type":"text","text":"```mermaid"}]},{"type":"paragraph","content":[{"type":"text","text":"flowchart LR"}]},{"type":"paragraph","content":[{"type":"text","text":"A[Install nanobot] --> B[Run nanobot onboard]"}]},{"type":"paragraph","content":[{"type":"text","text":"B --> C[Edit ~/.nanobot/config.json]"}]},{"type":"paragraph","content":[{"type":"text","text":"C --> D[Add providers]"}]},{"type":"paragraph","content":[{"type":"text","text":"C --> E[Add agents]"}]},{"type":"paragraph","content":[{"type":"text","text":"C --> F[Add channels]"}]},{"type":"paragraph","content":[{"type":"text","text":"D --> G[Test with nanobot agent]"}]},{"type":"paragraph","content":[{"type":"text","text":"E --> G"}]},{"type":"paragraph","content":[{"type":"text","text":"F --> H[Run nanobot gateway]"}]},{"type":"paragraph","content":[{"type":"text","text":"H --> I[Use from Telegram/Discord/Slack/...]"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 1 – Install nanobot"}]},{"type":"paragraph","content":[{"type":"text","text":"You have three options (from the README):"}]},{"type":"paragraph","content":[{"type":"text","text":"1. "},{"type":"text","marks":[{"type":"bold"}],"text":"Install from source (latest, recommended for dev)"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"git clone "},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://github.com/HKUDS/nanobot.git","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"https://github.com/HKUDS/nanobot.git"}]},{"type":"paragraph","content":[{"type":"text","text":"cd nanobot"}]},{"type":"paragraph","content":[{"type":"text","text":"pip install -e ."}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"2. "},{"type":"text","marks":[{"type":"bold"}],"text":"Install with uv (stable, fast)"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"uv tool install nanobot-ai"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"3. "},{"type":"text","marks":[{"type":"bold"}],"text":"Install from PyPI (stable)"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"pip install nanobot-ai"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"After install, you should have the "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot"},{"type":"text","text":" CLI on your "},{"type":"text","marks":[{"type":"code"}],"text":"PATH"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 2 – Initialize config & workspace"}]},{"type":"paragraph","content":[{"type":"text","text":"Run the onboarding command (this creates "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot"},{"type":"text","text":" and a basic config):"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot onboard"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"This creates "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot/config.json"},{"type":"text","text":" and a workspace directory."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 3 – Basic config.json structure"}]},{"type":"paragraph","content":[{"type":"text","text":"Open the config:"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"vim ~/.nanobot/config.json"}]},{"type":"paragraph","content":[{"type":"text","text":"# or"}]},{"type":"paragraph","content":[{"type":"text","text":"code ~/.nanobot/config.json"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"The minimal structure you care about is:"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"providers\": { ... },"}]},{"type":"paragraph","content":[{"type":"text","text":"\"agents\": { ... },"}]},{"type":"paragraph","content":[{"type":"text","text":"\"channels\": { ... }"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"providers"},{"type":"text","text":"** – LLM providers (OpenRouter, OpenAI, Anthropic, DeepSeek, Qwen, MiniMax, vLLM, etc.)"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"agents"},{"type":"text","text":"** – Agent defaults (which model, temperature, etc.)"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"channels"},{"type":"text","text":"** – Chat channels (Telegram, Discord, Slack, Email, etc.)"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 4 – Configure providers (LLM backend)"}]},{"type":"paragraph","content":[{"type":"text","text":"#### Option 1 – Use OpenRouter (recommended by the authors)"}]},{"type":"paragraph","content":[{"type":"text","text":"Example from README:"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"providers\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"openrouter\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiKey\": \"sk-or-v1-xxx\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"\"agents\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"defaults\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"model\": \"anthropic/claude-opus-4-5\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- Get your API key from "},{"type":"text","marks":[{"type":"code"}],"text":"https://openrouter.ai"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"#### Option 2 – Use a local model with vLLM"}]},{"type":"paragraph","content":[{"type":"text","text":"1. Start vLLM:"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"vllm serve meta-llama/Llama-3.1-8B-Instruct --port 8000"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"2. Configure nanobot to use it:"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"providers\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"vllm\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiKey\": \"dummy\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiBase\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://localhost:8000/v1","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"http://localhost:8000/v1"},{"type":"text","text":"\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"\"agents\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"defaults\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"model\": \"meta-llama/Llama-3.1-8B-Instruct\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"You can mix multiple providers if you want (e.g. "},{"type":"text","marks":[{"type":"code"}],"text":"openrouter"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"openai"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"deepseek"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"dashscope"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"zhipu"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"moonshot"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"minimax"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"groq"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"gemini"},{"type":"text","text":", etc.)."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 5 – (Optional) Tune agent defaults"}]},{"type":"paragraph","content":[{"type":"text","text":"Under "},{"type":"text","marks":[{"type":"code"}],"text":"agents.defaults"},{"type":"text","text":" you can set things like:"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"\"agents\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"defaults\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"model\": \"anthropic/claude-opus-4-5\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"temperature\": 0.7,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"tools\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"restrictToWorkspace\": true"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"tools.restrictToWorkspace: true"},{"type":"text","text":" is recommended for production to sandbox file/shell tools to the workspace directory."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 6 – Add chat channels (Telegram / Discord / Slack / Email / etc.)"}]},{"type":"paragraph","content":[{"type":"text","text":"You can enable one or more channels under the "},{"type":"text","marks":[{"type":"code"}],"text":"\"channels\""},{"type":"text","text":" key."}]},{"type":"paragraph","content":[{"type":"text","text":"#### 6.1 Telegram (recommended)"}]},{"type":"paragraph","content":[{"type":"text","text":"1. Create a Telegram bot via "},{"type":"text","marks":[{"type":"bold"}],"text":"@BotFather"},{"type":"text","text":" → "},{"type":"text","marks":[{"type":"code"}],"text":"/newbot"},{"type":"text","text":" and copy the token."}]},{"type":"paragraph","content":[{"type":"text","text":"2. Get your "},{"type":"text","marks":[{"type":"bold"}],"text":"user ID"},{"type":"text","text":" from Telegram settings (shown as "},{"type":"text","marks":[{"type":"code"}],"text":"@yourUserId"},{"type":"text","text":")."}]},{"type":"paragraph","content":[{"type":"text","text":"3. Add to "},{"type":"text","marks":[{"type":"code"}],"text":"config.json"},{"type":"text","text":":"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"channels\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"telegram\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"enabled\": true,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"token\": \"YOUR_BOT_TOKEN\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"allowFrom\": [\"YOUR_USER_ID\"]"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"4. Start the gateway:"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot gateway"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"Now talk to your bot on Telegram."}]},{"type":"paragraph","content":[{"type":"text","text":"#### 6.2 Discord"}]},{"type":"paragraph","content":[{"type":"text","text":"1. Create a Discord app + bot:"}]},{"type":"paragraph","content":[{"type":"text","text":"- Go to "},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://discord.com/developers/applications","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"https://discord.com/developers/applications"}]},{"type":"paragraph","content":[{"type":"text","text":"- Create application → Bot → Add Bot → copy "},{"type":"text","marks":[{"type":"bold"}],"text":"bot token"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"2. Enable "},{"type":"text","marks":[{"type":"bold"}],"text":"MESSAGE CONTENT INTENT"},{"type":"text","text":" (and optionally "},{"type":"text","marks":[{"type":"bold"}],"text":"SERVER MEMBERS INTENT"},{"type":"text","text":") in the Bot tab."}]},{"type":"paragraph","content":[{"type":"text","text":"3. Get your user ID: enable Developer Mode in Discord, right‑click your avatar → Copy User ID."}]},{"type":"paragraph","content":[{"type":"text","text":"4. Config:"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"channels\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"discord\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"enabled\": true,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"token\": \"YOUR_BOT_TOKEN\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"allowFrom\": [\"YOUR_USER_ID\"]"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"5. Invite the bot using OAuth2 → URL Generator, scopes "},{"type":"text","marks":[{"type":"code"}],"text":"bot"},{"type":"text","text":", permissions “Send Messages, Read Message History”."}]},{"type":"paragraph","content":[{"type":"text","text":"6. Run "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot gateway"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"#### 6.3 Slack"}]},{"type":"paragraph","content":[{"type":"text","text":"1. Create a Slack app (from scratch) in your workspace."}]},{"type":"paragraph","content":[{"type":"text","text":"2. Configure:"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"bold"}],"text":"Socket Mode"},{"type":"text","text":": ON → generate an "},{"type":"text","marks":[{"type":"bold"}],"text":"App‑Level Token"},{"type":"text","text":" with "},{"type":"text","marks":[{"type":"code"}],"text":"connections:write"},{"type":"text","text":" scope → copy "},{"type":"text","marks":[{"type":"code"}],"text":"xapp-..."},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"bold"}],"text":"OAuth & Permissions"},{"type":"text","text":": add bot scopes "},{"type":"text","marks":[{"type":"code"}],"text":"chat:write"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"reactions:write"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"app_mentions:read"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"bold"}],"text":"Event Subscriptions"},{"type":"text","text":": ON → subscribe to "},{"type":"text","marks":[{"type":"code"}],"text":"message.im"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"message.channels"},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"app_mention"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"bold"}],"text":"App Home"},{"type":"text","text":": enable Messages Tab and allow slash commands/messages."}]},{"type":"paragraph","content":[{"type":"text","text":"3. Install the app → copy the "},{"type":"text","marks":[{"type":"bold"}],"text":"Bot Token"},{"type":"text","text":" "},{"type":"text","marks":[{"type":"code"}],"text":"xoxb-..."},{"type":"text","text":")."}]},{"type":"paragraph","content":[{"type":"text","text":"4. Config:"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"channels\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"slack\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"enabled\": true,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"botToken\": \"xoxb-...\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"appToken\": \"xapp-...\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"groupPolicy\": \"mention\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"code"}],"text":"groupPolicy"},{"type":"text","text":" can be "},{"type":"text","marks":[{"type":"code"}],"text":"\"mention\""},{"type":"text","text":", "},{"type":"text","marks":[{"type":"code"}],"text":"\"open\""},{"type":"text","text":", or "},{"type":"text","marks":[{"type":"code"}],"text":"\"allowlist\""},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"5. Run "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot gateway"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"#### 6.4 Email (IMAP + SMTP)"}]},{"type":"paragraph","content":[{"type":"text","text":"Example for Gmail (you need an app password, not your main password):"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"channels\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"email\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"enabled\": true,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"consentGranted\": true,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"imapHost\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://imap.gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"imap.gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"imapPort\": 993,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"imapUsername\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"mailto:my-nanobot@gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"my-nanobot@gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"imapPassword\": \"your-app-password\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"smtpHost\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://smtp.gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"smtp.gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"smtpPort\": 587,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"smtpUsername\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"mailto:my-nanobot@gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"my-nanobot@gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"smtpPassword\": \"your-app-password\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"fromAddress\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"mailto:my-nanobot@gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"my-nanobot@gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"allowFrom\": [\""},{"type":"text","marks":[{"type":"link","attrs":{"href":"mailto:your-real-email@gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"your-real-email@gmail.com"},{"type":"text","text":"\"]"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- Set "},{"type":"text","marks":[{"type":"code"}],"text":"consentGranted: true"},{"type":"text","text":" to allow mailbox access."}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"allowFrom"},{"type":"text","text":" can be left empty to accept all senders, or restricted."}]},{"type":"paragraph","content":[{"type":"text","text":"- Then run "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot gateway"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"Similar patterns exist for "},{"type":"text","marks":[{"type":"bold"}],"text":"WhatsApp, Feishu, QQ, DingTalk, Mochat"},{"type":"text","text":" etc. in the README."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 7 – Test your config"}]},{"type":"paragraph","content":[{"type":"text","text":"1. "},{"type":"text","marks":[{"type":"bold"}],"text":"Quick CLI test"},{"type":"text","text":":"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot agent -m \"What is 2+2?\""}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"You should see the agent reply using your configured LLM."}]},{"type":"paragraph","content":[{"type":"text","text":"2. "},{"type":"text","marks":[{"type":"bold"}],"text":"If you enabled channels"},{"type":"text","text":", start the gateway:"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot gateway"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"Then send a message to your Telegram bot / Discord bot / Slack app / email address, etc."}]},{"type":"paragraph","content":[{"type":"text","text":"3. "},{"type":"text","marks":[{"type":"bold"}],"text":"Check status"},{"type":"text","text":":"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot status"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"This shows providers, channels, and other runtime info."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 8 – (Optional) Use Docker"}]},{"type":"paragraph","content":[{"type":"text","text":"If you prefer Docker, the README shows the pattern:"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"# Build"}]},{"type":"paragraph","content":[{"type":"text","text":"docker build -t nanobot ."}]},{"type":"paragraph","content":[{"type":"text","text":"# Initialize config (first time)"}]},{"type":"paragraph","content":[{"type":"text","text":"docker run -v ~/.nanobot:/root/.nanobot --rm nanobot onboard"}]},{"type":"paragraph","content":[{"type":"text","text":"# Edit config on host"}]},{"type":"paragraph","content":[{"type":"text","text":"vim ~/.nanobot/config.json"}]},{"type":"paragraph","content":[{"type":"text","text":"# Run gateway"}]},{"type":"paragraph","content":[{"type":"text","text":"docker run -v ~/.nanobot:/root/.nanobot -p 18790:18790 nanobot gateway"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"## Part B – nanobot-ai/nanobot: Step‑by‑Step Config (MCP host)"}]},{"type":"paragraph","content":[{"type":"text","text":"If you meant the "},{"type":"text","marks":[{"type":"bold"}],"text":"MCP"},{"type":"text","text":" project "},{"type":"text","marks":[{"type":"code"}],"text":"github.com/nanobot-ai/nanobot"},{"type":"text","text":"), here’s a concise guide."}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 1 – Install the CLI"}]},{"type":"paragraph","content":[{"type":"text","text":"Recommended (Homebrew):"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"brew install nanobot-ai/tap/nanobot"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"This gives you the "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot"},{"type":"text","text":" CLI for running an MCP host."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 2 – Set LLM API keys"}]},{"type":"paragraph","content":[{"type":"text","text":"Set environment variables for your provider:"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"# For OpenAI models"}]},{"type":"paragraph","content":[{"type":"text","text":"export OPENAI_API_KEY=\"sk-...\""}]},{"type":"paragraph","content":[{"type":"text","text":"# For Anthropic models"}]},{"type":"paragraph","content":[{"type":"text","text":"export ANTHROPIC_API_KEY=\"sk-ant-...\""}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"Nanobot automatically selects the provider based on the model name you use in the config."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 3 – Single‑file config (nanobot.yaml)"}]},{"type":"paragraph","content":[{"type":"text","text":"Create a file "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot.yaml"},{"type":"text","text":" in your project:"}]},{"type":"paragraph","content":[{"type":"text","text":"```yaml"}]},{"type":"paragraph","content":[{"type":"text","text":"agents:"}]},{"type":"paragraph","content":[{"type":"text","text":"dealer:"}]},{"type":"paragraph","content":[{"type":"text","text":"name: Blackjack Dealer"}]},{"type":"paragraph","content":[{"type":"text","text":"model: gpt-4.1"}]},{"type":"paragraph","content":[{"type":"text","text":"mcpServers:"}]},{"type":"paragraph","content":[{"type":"text","text":"- blackjackmcp"}]},{"type":"paragraph","content":[{"type":"text","text":"mcpServers:"}]},{"type":"paragraph","content":[{"type":"text","text":"blackjackmcp:"}]},{"type":"paragraph","content":[{"type":"text","text":"url: "},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://blackjack.nanobot.ai/mcp","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"https://blackjack.nanobot.ai/mcp"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"Then run:"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot run ./nanobot.yaml"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"The UI will be available at "},{"type":"text","marks":[{"type":"code"}],"text":"http://localhost:8080"},{"type":"text","text":"."}]},{"type":"paragraph","content":[{"type":"text","text":"You can define multiple agents and multiple MCP servers in this single file."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 4 – Directory‑based config (agents/*.md)"}]},{"type":"paragraph","content":[{"type":"text","text":"If you prefer a more modular setup, use a directory:"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"my-config/"}]},{"type":"paragraph","content":[{"type":"text","text":"├── agents/"}]},{"type":"paragraph","content":[{"type":"text","text":"│ ├── "},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://main.md","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"main.md"},{"type":"text","text":" # becomes the default agent"}]},{"type":"paragraph","content":[{"type":"text","text":"│ └── "},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://helper.md","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"helper.md"}]},{"type":"paragraph","content":[{"type":"text","text":"└── mcp-servers.yaml # or mcp-servers.json"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"agents/"},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://main.md","target":"_blank","rel":"noopener noreferrer nofollow","class":null}},{"type":"bold"}],"text":"main.md"},{"type":"text","text":" (YAML front‑matter + Markdown body):"}]},{"type":"paragraph","content":[{"type":"text","text":"```yaml"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"name: Shopping Assistant"}]},{"type":"paragraph","content":[{"type":"text","text":"model: claude-3-7-sonnet-latest"}]},{"type":"paragraph","content":[{"type":"text","text":"mcpServers:"}]},{"type":"paragraph","content":[{"type":"text","text":"- store"}]},{"type":"paragraph","content":[{"type":"text","text":"temperature: 0.7"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"You are a helpful shopping assistant. Help users find products and answer questions."}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"mcp-servers.yaml"},{"type":"text","text":":"}]},{"type":"paragraph","content":[{"type":"text","text":"```yaml"}]},{"type":"paragraph","content":[{"type":"text","text":"store:"}]},{"type":"paragraph","content":[{"type":"text","text":"url: "},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://example.com/mcp","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"https://example.com/mcp"}]},{"type":"paragraph","content":[{"type":"text","text":"headers:"}]},{"type":"paragraph","content":[{"type":"text","text":"Authorization: Bearer ${MY_TOKEN}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"Then run:"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot run ./my-config/"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"Nanobot will:"}]},{"type":"paragraph","content":[{"type":"text","text":"- Treat each "},{"type":"text","marks":[{"type":"code"}],"text":".md"},{"type":"text","text":" in "},{"type":"text","marks":[{"type":"code"}],"text":"agents/"},{"type":"text","text":" as an agent."}]},{"type":"paragraph","content":[{"type":"text","text":"- Use "},{"type":"text","marks":[{"type":"code"}],"text":"agents/main.md"},{"type":"text","text":" as the default entrypoint if it exists."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### Step 5 – Use the agent"}]},{"type":"paragraph","content":[{"type":"text","text":"Once "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot run"},{"type":"text","text":" is up:"}]},{"type":"paragraph","content":[{"type":"text","text":"1. Open "},{"type":"text","marks":[{"type":"code"}],"text":"http://localhost:8080"},{"type":"text","text":" in your browser."}]},{"type":"paragraph","content":[{"type":"text","text":"2. Use the chat UI to talk to your agent."}]},{"type":"paragraph","content":[{"type":"text","text":"3. The agent will call the configured MCP servers automatically (e.g. Blackjack MCP, Hugging Face MCP, Shopify, etc.)."}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":3,"id":"下面我在你已经有的配置步骤基础上结合仓库源码和-README对-HKUDSnanobot-做一个更系统的进一步解释讲清楚它到底是什么怎么跑起来核心模块怎么工作以及怎么根据自己需求改配置"},"content":[{"type":"text","text":"下面我在你已经有的配置步骤基础上，结合仓库源码和 README，对 **HKUDS/nanobot** 做一个更系统的“进一步解释”，讲清楚它到底是什么、怎么跑起来、核心模块怎么工作，以及怎么根据自己需求改配置。"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"## 1. nanobot 是什么？"}]},{"type":"paragraph","content":[{"type":"text","text":"**定位：极简个人 AI 助手框架（~4k 行核心代码）**"}]},{"type":"paragraph","content":[{"type":"text","text":"- 核心代码只有大约 **3,587 行**，官方称比 Clawdbot 的 430k+ 行小 99%。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 目标："}]},{"type":"paragraph","content":[{"type":"text","text":"- 保留核心 Agent 能力（对话、工具调用、记忆等），"}]},{"type":"paragraph","content":[{"type":"text","text":"- 但代码尽量少、好读、好改，方便研究和二次开发。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 典型能力（README 里列的）："}]},{"type":"paragraph","content":[{"type":"text","text":"- 24/7 实时行情分析"}]},{"type":"paragraph","content":[{"type":"text","text":"- 全栈软件工程师辅助"}]},{"type":"paragraph","content":[{"type":"text","text":"- 智能日常作息管理（日程、提醒）"}]},{"type":"paragraph","content":[{"type":"text","text":"- 个人知识助手（检索、记忆、推理）"}]},{"type":"paragraph","content":[{"type":"text","text":"**一句话概括：**"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot 是一个“极简但功能完整”的个人 Agent 框架，把多平台聊天（Telegram / Discord / Slack / 飞书 / 钉钉 / QQ / WhatsApp / Email / Mochat 等）和多 LLM 提供方统一封装起来，方便你当“私人 AI 助手”用。"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"## 2. 整体架构长什么样？"}]},{"type":"paragraph","content":[{"type":"text","text":"虽然 README 里没有单独章节，但仓库里有 "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot_arch.png"},{"type":"text","text":" 架构图，配合源码目录结构可以理解整个系统。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 2.1 目录结构（核心模块）"}]},{"type":"paragraph","content":[{"type":"text","text":"```text"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot/"}]},{"type":"paragraph","content":[{"type":"text","text":"├── agent/ # 核心_agent_逻辑（主循环、上下文、记忆、工具等）"}]},{"type":"paragraph","content":[{"type":"text","text":"│ ├── "},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://loop.py","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"loop.py"},{"type":"text","text":" # Agent 主循环：LLM <-> 工具调用"}]},{"type":"paragraph","content":[{"type":"text","text":"│ ├── "},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://context.py","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"context.py"},{"type":"text","text":" # 提示构建（系统提示、历史消息等）"}]},{"type":"paragraph","content":[{"type":"text","text":"│ ├── "},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://memory.py","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"memory.py"},{"type":"text","text":" # 持久化记忆"}]},{"type":"paragraph","content":[{"type":"text","text":"│ ├── "},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://skills.py","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"skills.py"},{"type":"text","text":" # 技能加载器"}]},{"type":"paragraph","content":[{"type":"text","text":"│ ├── "},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://subagent.py","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"subagent.py"},{"type":"text","text":" # 后台子任务执行"}]},{"type":"paragraph","content":[{"type":"text","text":"│ └── tools/ # 内置工具（文件、shell、spawn 等）"}]},{"type":"paragraph","content":[{"type":"text","text":"├── skills/ # 打包好的技能：github、weather、tmux 等"}]},{"type":"paragraph","content":[{"type":"text","text":"├── channels/ # 各种聊天通道集成（Telegram/Discord/Slack/...）"}]},{"type":"paragraph","content":[{"type":"text","text":"├── bus/ # 消息路由（不同通道的消息统一分发）"}]},{"type":"paragraph","content":[{"type":"text","text":"├── cron/ # 定时任务（类似 cron）"}]},{"type":"paragraph","content":[{"type":"text","text":"├── heartbeat/ # 主动“唤醒”机制（定时自检）"}]},{"type":"paragraph","content":[{"type":"text","text":"├── providers/ # LLM 提供方封装（OpenRouter、Anthropic、OpenAI 等）"}]},{"type":"paragraph","content":[{"type":"text","text":"├── session/ # 会话管理"}]},{"type":"paragraph","content":[{"type":"text","text":"├── config/ # 配置模型（"},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://schema.py","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"schema.py"},{"type":"text","text":" 定义所有配置结构）"}]},{"type":"paragraph","content":[{"type":"text","text":"└── cli/ # 命令行入口：onboard、agent、gateway、status 等"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"### 2.2 用一张图理解数据流"}]},{"type":"paragraph","content":[{"type":"text","text":"下面是一个简化版的数据流和组件关系（从你在 App 里说话，到 Agent 处理，再到回复）："}]},{"type":"paragraph","content":[{"type":"text","text":"```mermaid"}]},{"type":"paragraph","content":[{"type":"text","text":"flowchart LR"}]},{"type":"paragraph","content":[{"type":"text","text":"U[用户] -->|发消息| C[Channels: Telegram/Discord/Slack/Email/...]"}]},{"type":"paragraph","content":[{"type":"text","text":"C -->|统一消息结构| B[Bus: 消息路由]"}]},{"type":"paragraph","content":[{"type":"text","text":"B -->|调度| A[Agent: agent/"},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://loop.py","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"loop.py"},{"type":"text","text":"]"}]},{"type":"paragraph","content":[{"type":"text","text":"A -->|调用| P[Providers: OpenRouter/DeepSeek/Qwen/...]"}]},{"type":"paragraph","content":[{"type":"text","text":"P -->|LLM 响应| A"}]},{"type":"paragraph","content":[{"type":"text","text":"A -->|工具调用| T[Tools: 文件/Shell/技能]"}]},{"type":"paragraph","content":[{"type":"text","text":"T -->|结果| A"}]},{"type":"paragraph","content":[{"type":"text","text":"A -->|生成回复| B"}]},{"type":"paragraph","content":[{"type":"text","text":"B -->|按会话路由| C"}]},{"type":"paragraph","content":[{"type":"text","text":"C -->|回复| U"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"**理解要点：**"}]},{"type":"paragraph","content":[{"type":"text","text":"- **Channels** 只负责“怎么接入聊天平台”，消息格式统一丢给 **Bus**。"}]},{"type":"paragraph","content":[{"type":"text","text":"- **Bus** 再把消息交给 **Agent**，Agent 不关心具体是哪个平台来的。"}]},{"type":"paragraph","content":[{"type":"text","text":"- **Agent** 通过 **Providers** 调 LLM，通过 **Tools/Skills** 调各种能力。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 这样你就可以“一套 Agent 逻辑 + 多个通道”复用。"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"## 3. 配置文件到底在干什么？"}]},{"type":"paragraph","content":[{"type":"text","text":"配置文件 "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot/config.json"},{"type":"text","text":" 对应的是 "},{"type":"text","marks":[{"type":"code"}],"text":"config/schema.py"},{"type":"text","text":" 里的 Pydantic 模型。"}]},{"type":"paragraph","content":[{"type":"text","text":"顶层结构大致是："}]},{"type":"paragraph","content":[{"type":"text","text":"```python"}]},{"type":"paragraph","content":[{"type":"text","text":"class Config(BaseSettings):"}]},{"type":"paragraph","content":[{"type":"text","text":"agents: AgentsConfig # Agent 默认行为"}]},{"type":"paragraph","content":[{"type":"text","text":"channels: ChannelsConfig # 各聊天通道配置"}]},{"type":"paragraph","content":[{"type":"text","text":"providers: ProvidersConfig # 各 LLM 提供方配置"}]},{"type":"paragraph","content":[{"type":"text","text":"gateway: GatewayConfig # gateway 服务配置"}]},{"type":"paragraph","content":[{"type":"text","text":"tools: ToolsConfig # 工具相关配置"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"### 3.1 providers：怎么选 LLM 后端"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"code"}],"text":"ProvidersConfig"},{"type":"text","text":" 里预定义了很多提供方："}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"openrouter"},{"type":"text","text":"：推荐，聚合几乎所有模型（Claude、GPT、Gemini、DeepSeek、Qwen 等）。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"anthropicopenaideepseekgroqgeminiminimaxmoonshotdashscope"},{"type":"text","text":"（通义千问）"},{"type":"text","marks":[{"type":"code"}],"text":"zhipuaihubmixvllm"},{"type":"text","text":" 等。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"custom"},{"type":"text","text":"：任意 OpenAI 兼容 API。"}]},{"type":"paragraph","content":[{"type":"text","text":"**ProviderConfig 结构**："}]},{"type":"paragraph","content":[{"type":"text","text":"```python"}]},{"type":"paragraph","content":[{"type":"text","text":"class ProviderConfig(BaseModel):"}]},{"type":"paragraph","content":[{"type":"text","text":"api_key: str = \"\""}]},{"type":"paragraph","content":[{"type":"text","text":"api_base: str | None = None"}]},{"type":"paragraph","content":[{"type":"text","text":"extra_headers: dict[str, str] | None = None"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"对应的 JSON 片段（README 示例）："}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"providers\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"openrouter\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiKey\": \"sk-or-v1-xxx\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"\"agents\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"defaults\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"model\": \"anthropic/claude-opus-4-5\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"**工作流程：**"}]},{"type":"paragraph","content":[{"type":"text","text":"1. 你在 "},{"type":"text","marks":[{"type":"code"}],"text":"agents.defaults.model"},{"type":"text","text":" 里写上要用的模型名，比如 "},{"type":"text","marks":[{"type":"code"}],"text":"\"anthropic/claude-opus-4-5\""},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"2. nanobot 根据 "},{"type":"text","marks":[{"type":"code"}],"text":"ProvidersConfig"},{"type":"text","text":" + "},{"type":"text","marks":[{"type":"code"}],"text":"registry.py"},{"type":"text","text":" 里的关键词匹配，自动选择对应的提供方。"}]},{"type":"paragraph","content":[{"type":"text","text":"3. 如果是 OpenRouter 这种“网关型”提供方，会自动拼接前缀，比如 "},{"type":"text","marks":[{"type":"code"}],"text":"openrouter/anthropic/claude-opus-4-5"},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"**本地模型（vLLM）示例**："}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"vllm serve meta-llama/Llama-3.1-8B-Instruct --port 8000"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"providers\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"vllm\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiKey\": \"dummy\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiBase\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://localhost:8000/v1","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"http://localhost:8000/v1"},{"type":"text","text":"\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"\"agents\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"defaults\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"model\": \"meta-llama/Llama-3.1-8B-Instruct\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"### 3.2 agents：Agent 默认行为"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"code"}],"text":"AgentsConfig"},{"type":"text","text":" 目前主要是 "},{"type":"text","marks":[{"type":"code"}],"text":"defaults"},{"type":"text","text":"："}]},{"type":"paragraph","content":[{"type":"text","text":"```python"}]},{"type":"paragraph","content":[{"type":"text","text":"class AgentDefaults(BaseModel):"}]},{"type":"paragraph","content":[{"type":"text","text":"workspace: str = \"~/.nanobot/workspace\""}]},{"type":"paragraph","content":[{"type":"text","text":"model: str = \"anthropic/claude-opus-4-5\""}]},{"type":"paragraph","content":[{"type":"text","text":"max_tokens: int = 8192"}]},{"type":"paragraph","content":[{"type":"text","text":"temperature: float = 0.7"}]},{"type":"paragraph","content":[{"type":"text","text":"max_tool_iterations: int = 20"}]},{"type":"paragraph","content":[{"type":"text","text":"memory_window: int = 50"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"你可以理解为："}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"workspace"},{"type":"text","text":"：Agent 所有文件操作的“根目录”，工具会被限制在这个目录里（如果开了沙箱）。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"model"},{"type":"text","text":"：默认使用的模型（会被 providers 匹配）。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"memory_window"},{"type":"text","text":"：保留多少轮对话历史作为“短期记忆”。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 3.3 channels：多平台通道配置"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"code"}],"text":"ChannelsConfig"},{"type":"text","text":" 定义了所有支持的通道："}]},{"type":"paragraph","content":[{"type":"text","text":"```python"}]},{"type":"paragraph","content":[{"type":"text","text":"class ChannelsConfig(BaseModel):"}]},{"type":"paragraph","content":[{"type":"text","text":"whatsapp: WhatsAppConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"telegram: TelegramConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"discord: DiscordConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"feishu: FeishuConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"mochat: MochatConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"dingtalk: DingTalkConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"email: EmailConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"slack: SlackConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"qq: QQConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"每个通道都有一个 "},{"type":"text","marks":[{"type":"code"}],"text":"enabled"},{"type":"text","text":" 开关和一堆连接参数，比如："}]},{"type":"paragraph","content":[{"type":"text","text":"- Telegram"},{"type":"text","marks":[{"type":"code"}],"text":"token"},{"type":"text","text":" + "},{"type":"text","marks":[{"type":"code"}],"text":"allow_from"},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"- Discord"},{"type":"text","marks":[{"type":"code"}],"text":"token"},{"type":"text","text":" + "},{"type":"text","marks":[{"type":"code"}],"text":"intents"},{"type":"text","text":" + "},{"type":"text","marks":[{"type":"code"}],"text":"allow_from"},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"- Slack"},{"type":"text","marks":[{"type":"code"}],"text":"bot_token"},{"type":"text","text":" + "},{"type":"text","marks":[{"type":"code"}],"text":"app_token"},{"type":"text","text":" + "},{"type":"text","marks":[{"type":"code"}],"text":"group_policy"},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"- Email：IMAP/SMTP 相关配置 + "},{"type":"text","marks":[{"type":"code"}],"text":"consent_grantedauto_reply_enabled"},{"type":"text","text":" 等。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 飞书、钉钉、QQ、Mochat 等，基本都是 AppID/AppSecret 或 Token + "},{"type":"text","marks":[{"type":"code"}],"text":"allow_from"},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"**关键点：**"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"allow_from"},{"type":"text","text":" 是白名单："}]},{"type":"paragraph","content":[{"type":"text","text":"- 为空：允许所有人使用。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 非空：只允许列表里的用户 ID / 手机号 / 邮箱 等访问。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 对于生产环境，强烈建议配置 "},{"type":"text","marks":[{"type":"code"}],"text":"allow_from"},{"type":"text","text":"，避免被别人滥用。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 3.4 tools：工具权限与沙箱"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"code"}],"text":"ToolsConfig"},{"type":"text","text":" 里有一个重要开关"},{"type":"text","marks":[{"type":"code"}],"text":"restrict_to_workspace"},{"type":"text","text":"："}]},{"type":"paragraph","content":[{"type":"text","text":"```python"}]},{"type":"paragraph","content":[{"type":"text","text":"class ToolsConfig(BaseModel):"}]},{"type":"paragraph","content":[{"type":"text","text":"web: WebToolsConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"exec: ExecToolConfig"}]},{"type":"paragraph","content":[{"type":"text","text":"restrict_to_workspace: bool = False"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- 为 "},{"type":"text","marks":[{"type":"code"}],"text":"true"},{"type":"text","text":" 时，所有工具（文件读写、shell 执行等）都只能访问 "},{"type":"text","marks":[{"type":"code"}],"text":"workspace"},{"type":"text","text":" 目录，防止路径穿越攻击。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 对应 JSON："}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"\"tools\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"restrictToWorkspace\": true"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"README 里也建议在生产环境开启。"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"## 4. 从“启动流程”再看一遍系统"}]},{"type":"paragraph","content":[{"type":"text","text":"结合 README 的 CLI 说明，可以按“启动流程”理解系统："}]},{"type":"paragraph","content":[{"type":"text","text":"### 4.1 初始化"},{"type":"text","marks":[{"type":"code"}],"text":"nanobot onboard"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot onboard"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- 创建 "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot"},{"type":"text","text":" 目录。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 生成初始 "},{"type":"text","marks":[{"type":"code"}],"text":"config.json"},{"type":"text","text":" 和 "},{"type":"text","marks":[{"type":"code"}],"text":"workspace"},{"type":"text","text":" 目录。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 相当于“安装向导”。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 4.2 交互式对话"},{"type":"text","marks":[{"type":"code"}],"text":"nanobot agent"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot agent -m \"What is 2+2?\""}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot agent # 交互模式"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- 直接在 CLI 里和 Agent 聊天。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 不需要启动 gateway，适合调试和简单使用。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 4.3 多通道网关"},{"type":"text","marks":[{"type":"code"}],"text":"nanobot gateway"}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot gateway"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- 启动一个网关服务，监听配置中启用的所有通道（Telegram/Discord/Slack/Email 等）。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 各通道的消息通过 bus 转发给 Agent，再由 Agent 统一处理。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 如果你希望“一个机器人，多平台统一聊天”，就用 gateway。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 4.4 状态与定时任务"},{"type":"text","marks":[{"type":"code"}],"text":"nanobot status"},{"type":"text","text":" / "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot cron"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot status"},{"type":"text","text":"：查看当前配置、提供方状态、通道状态等。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot cron"},{"type":"text","text":"：管理定时任务（类似 cron）："}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot cron add --name \"daily\" --message \"Good morning!\" --cron \"0 9 * * *\""}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot cron list"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot cron remove <job_id>"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"## 5. 实际配置时的一些“坑”和建议"}]},{"type":"paragraph","content":[{"type":"text","text":"结合 README 和 schema，再补充几个实战要点："}]},{"type":"paragraph","content":[{"type":"text","text":"### 5.1 多 Provider 怎么选？"}]},{"type":"paragraph","content":[{"type":"text","text":"- 想要“全球模型一把梭”："}]},{"type":"paragraph","content":[{"type":"text","text":"- 用 "},{"type":"text","marks":[{"type":"code"}],"text":"openrouter"},{"type":"text","text":"，一个 key 访问 Claude / GPT / Gemini / DeepSeek / Qwen 等。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 在国内想用国产模型："}]},{"type":"paragraph","content":[{"type":"text","text":"- DeepSeek、Moonshot/Kimi、Qwen（通义千问）、GLM（智谱）、MiniMax 等，都有对应提供方。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 注意部分提供方需要设置 "},{"type":"text","marks":[{"type":"code"}],"text":"apiBase"},{"type":"text","text":"，比如："}]},{"type":"paragraph","content":[{"type":"text","text":"- Zhipu Coding Plan"},{"type":"text","marks":[{"type":"code"}],"text":"\"apiBase\": \"https://open.bigmodel.cn/api/coding/paas/v4\""},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://open.bigmodel.cn/api/coding/paas/v4\"`。","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"- MiniMax 中国大陆平台"},{"type":"text","marks":[{"type":"code"}],"text":"\"apiBase\": \"https://api.minimaxi.com/v1\""},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://api.minimaxi.com/v1\"`。","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 5.2 通道安全配置"}]},{"type":"paragraph","content":[{"type":"text","text":"- **一定要设置 "},{"type":"text","marks":[{"type":"code"}],"text":"allow_from"},{"type":"text","text":"**，尤其是："}]},{"type":"paragraph","content":[{"type":"text","text":"- Telegram：只允许自己的 user_id。"}]},{"type":"paragraph","content":[{"type":"text","text":"- Discord：只允许自己的用户 ID。"}]},{"type":"paragraph","content":[{"type":"text","text":"- Slack：只允许自己的工作区成员 / 特定频道。"}]},{"type":"paragraph","content":[{"type":"text","text":"- Email 通道："}]},{"type":"paragraph","content":[{"type":"text","text":"- 给机器人一个专用邮箱。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 开启 2FA，用“应用专用密码”而不是真实密码。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"consentGranted"},{"type":"text","text":" 要设为 "},{"type":"text","marks":[{"type":"code"}],"text":"true"},{"type":"text","text":"，否则不会真正访问邮箱。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 5.3 本地模型与 vLLM"}]},{"type":"paragraph","content":[{"type":"text","text":"- vLLM 本质上是暴露一个 OpenAI 兼容 API，nanobot 通过 "},{"type":"text","marks":[{"type":"code"}],"text":"vllm"},{"type":"text","text":" 提供方对接。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"apiKey"},{"type":"text","text":" 可以随便填（本地不校验），但 "},{"type":"text","marks":[{"type":"code"}],"text":"apiBase"},{"type":"text","text":" 要指向你的 vLLM 服务地址。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 5.4 Docker 部署时的注意事项"}]},{"type":"paragraph","content":[{"type":"text","text":"README 给的 Docker 命令："}]},{"type":"paragraph","content":[{"type":"text","text":"```bash"}]},{"type":"paragraph","content":[{"type":"text","text":"docker build -t nanobot ."}]},{"type":"paragraph","content":[{"type":"text","text":"docker run -v ~/.nanobot:/root/.nanobot --rm nanobot onboard"}]},{"type":"paragraph","content":[{"type":"text","text":"vim ~/.nanobot/config.json"}]},{"type":"paragraph","content":[{"type":"text","text":"docker run -v ~/.nanobot:/root/.nanobot -p 18790:18790 nanobot gateway"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"-v ~/.nanobot:/root/.nanobot"},{"type":"text","text":"：把本地配置目录挂到容器里，这样："}]},{"type":"paragraph","content":[{"type":"text","text":"- 你在宿主机改 "},{"type":"text","marks":[{"type":"code"}],"text":"config.json"},{"type":"text","text":"，容器里立刻生效。"}]},{"type":"paragraph","content":[{"type":"text","text":"- workspace 目录也在宿主机持久化。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 生产环境建议："}]},{"type":"paragraph","content":[{"type":"text","text":"- 把 "},{"type":"text","marks":[{"type":"code"}],"text":"config.json"},{"type":"text","text":" 权限收紧（600），避免 key 泄露。"}]},{"type":"paragraph","content":[{"type":"text","text":"- 使用环境变量注入 API key，而不是写死在 JSON 里。"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"## 6. 如果你打算二次开发 / 研究"}]},{"type":"paragraph","content":[{"type":"text","text":"nanobot 代码量很小，特别适合作为“研究用 Agent 框架”："}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"agent/loop.py"},{"type":"text","text":"：Agent 主循环，理解“思考-调用工具-再思考”的关键。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"agent/memory.py"},{"type":"text","text":"：记忆管理，如何把长期/短期记忆拼进 prompt。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"agent/tools/"},{"type":"text","text":"：内置工具实现，你可以参考写自己的工具。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"skills/"},{"type":"text","text":"：官方打包的一些技能（github、weather、tmux 等），可以作为“技能开发模板”。"}]},{"type":"paragraph","content":[{"type":"text","text":"- "},{"type":"text","marks":[{"type":"code"}],"text":"providers/registry.py"},{"type":"text","text":"：提供方注册表，你可以按 README 里的 2 步新增自己的提供方。"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":3,"id":"准确安全且易于上手的配置示例和指南"},"content":[{"type":"text","text":"准确、安全且易于上手的配置示例和指南"}]},{"type":"paragraph","content":[{"type":"text","text":"香港大学数据科学研究所（HKUDS）的 "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot"},{"type":"text","text":" 项目是一个轻量级的个人AI助手框架。根据您的需求，我为您准备了一份仅启用 "},{"type":"text","marks":[{"type":"bold"}],"text":"Telegram"},{"type":"text","text":" 和 "},{"type":"text","marks":[{"type":"bold"}],"text":"Email"},{"type":"text","text":" 渠道的完整 "},{"type":"text","marks":[{"type":"code"}],"text":"config.json"},{"type":"text","text":" 配置示例，并详细解释了每一部分的作用。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 完整 "},{"type":"text","marks":[{"type":"code"}],"text":"config.json"},{"type":"text","text":" 示例"}]},{"type":"paragraph","content":[{"type":"text","text":"请将以下内容保存为 "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot/config.json"},{"type":"text","text":" 文件，并将所有 "},{"type":"text","marks":[{"type":"code"}],"text":"<<...>>"},{"type":"text","text":" 占位符替换为您自己的实际信息。"}]},{"type":"paragraph","content":[{"type":"text","text":"```json"}]},{"type":"paragraph","content":[{"type":"text","text":"{"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"// 1. LLM 提供方配置"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"\"providers\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"// 推荐：通过 OpenRouter 聚合访问几乎所有主流模型"}]},{"type":"paragraph","content":[{"type":"text","text":"\"openrouter\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiKey\": \"<<YOUR_OPENROUTER_API_KEY>>\""}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"// 示例：直接使用 DeepSeek API"}]},{"type":"paragraph","content":[{"type":"text","text":"\"deepseek\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiKey\": \"<<YOUR_DEEPSEEK_API_KEY>>\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"apiBase\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://api.deepseek.com/v1","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"https://api.deepseek.com/v1"},{"type":"text","text":"\""}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"// 2. Agent 默认行为配置"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"\"agents\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"defaults\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"// 指定默认使用的模型，这里的名称会被 providers 匹配"}]},{"type":"paragraph","content":[{"type":"text","text":"\"model\": \"anthropic/claude-opus-4-5\", // 对应 OpenRouter 中的模型名"}]},{"type":"paragraph","content":[{"type":"text","text":"// \"model\": \"deepseek-chat\", // 如果使用 DeepSeek，取消此行注释并注释上一行"}]},{"type":"paragraph","content":[{"type":"text","text":"\"temperature\": 0.7,"}]},{"type":"paragraph","content":[{"type":"text","text":"// 强烈建议开启此项，将工具（如文件读写）限制在 workspace 目录内，确保安全"}]},{"type":"paragraph","content":[{"type":"text","text":"\"tools\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"restrictToWorkspace\": true"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"// 3. 聊天渠道配置"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"\"channels\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"// Telegram 机器人配置"}]},{"type":"paragraph","content":[{"type":"text","text":"\"telegram\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"enabled\": true,"}]},{"type":"paragraph","content":[{"type":"text","text":"// 从 @BotFather 获取的 Token"}]},{"type":"paragraph","content":[{"type":"text","text":"\"token\": \"<<YOUR_TELEGRAM_BOT_TOKEN>>\","}]},{"type":"paragraph","content":[{"type":"text","text":"// 用户 ID 白名单，为空则允许所有人，建议填写您的 Telegram 用户 ID"}]},{"type":"paragraph","content":[{"type":"text","text":"\"allowFrom\": [\"<<YOUR_TELEGRAM_USER_ID>>\"]"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"// 电子邮件收发配置"}]},{"type":"paragraph","content":[{"type":"text","text":"\"email\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"\"enabled\": true,"}]},{"type":"paragraph","content":[{"type":"text","text":"// 同意邮箱访问协议，必须为 true 才能正常收发邮件"}]},{"type":"paragraph","content":[{"type":"text","text":"\"consentGranted\": true,"}]},{"type":"paragraph","content":[{"type":"text","text":"// IMAP 服务器配置（用于接收邮件）"}]},{"type":"paragraph","content":[{"type":"text","text":"\"imapHost\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://imap.gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"imap.gmail.com"},{"type":"text","text":"\", // 例如 Gmail，其他邮箱请自行修改"}]},{"type":"paragraph","content":[{"type":"text","text":"\"imapPort\": 993,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"imapUsername\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"mailto:your.email@gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"your.email@gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"// 建议使用“应用专用密码”，而非您的邮箱登录密码"}]},{"type":"paragraph","content":[{"type":"text","text":"\"imapPassword\": \"<<YOUR_EMAIL_APP_PASSWORD>>\","}]},{"type":"paragraph","content":[{"type":"text","text":"// SMTP 服务器配置（用于发送回复邮件）"}]},{"type":"paragraph","content":[{"type":"text","text":"\"smtpHost\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"http://smtp.gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"smtp.gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"smtpPort\": 587,"}]},{"type":"paragraph","content":[{"type":"text","text":"\"smtpUsername\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"mailto:your.email@gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"your.email@gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"smtpPassword\": \"<<YOUR_EMAIL_APP_PASSWORD>>\","}]},{"type":"paragraph","content":[{"type":"text","text":"// 发送邮件时显示的发件人地址"}]},{"type":"paragraph","content":[{"type":"text","text":"\"fromAddress\": \""},{"type":"text","marks":[{"type":"link","attrs":{"href":"mailto:your.email@gmail.com","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"your.email@gmail.com"},{"type":"text","text":"\","}]},{"type":"paragraph","content":[{"type":"text","text":"// 允许发邮件给您的发件人白名单，为空则接受所有邮件"}]},{"type":"paragraph","content":[{"type":"text","text":"\"allowFrom\": [\"<<YOUR_TRUSTED_SENDER_EMAIL>>\"]"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"// 4. 网关服务配置"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"\"gateway\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"// 网关服务监听地址，默认即可，用于管理消息收发"}]},{"type":"paragraph","content":[{"type":"text","text":"\"host\": \"0.0.0.0\","}]},{"type":"paragraph","content":[{"type":"text","text":"\"port\": 18790"}]},{"type":"paragraph","content":[{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"// 5. 工具安全配置"}]},{"type":"paragraph","content":[{"type":"text","text":"// ======================="}]},{"type":"paragraph","content":[{"type":"text","text":"\"tools\": {"}]},{"type":"paragraph","content":[{"type":"text","text":"// 全局限制所有工具只能在 workspace 目录下操作，防止系统文件被修改"}]},{"type":"paragraph","content":[{"type":"text","text":"\"restrictToWorkspace\": true"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"}"}]},{"type":"paragraph","content":[{"type":"text","text":"```"}]},{"type":"paragraph","content":[{"type":"text","text":"---"}]},{"type":"paragraph","content":[{"type":"text","text":"### 配置详解"}]},{"type":"paragraph","content":[{"type":"text","text":"#### 1. "},{"type":"text","marks":[{"type":"code"}],"text":"providers"},{"type":"text","text":" (LLM 提供方配置)"}]},{"type":"paragraph","content":[{"type":"text","text":"这是您的机器人“大脑”的来源。您至少需要配置一个提供商。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"openrouter"},{"type":"text","text":"**: 这是一个聚合 API，通过一个 key 访问多种模型（如 Claude, GPT, Gemini 等）。您需要在 [OpenRouter]("},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://openrouter.ai/","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"https://openrouter.ai/"},{"type":"text","text":") 注册并获取 API Key。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"deepseek"},{"type":"text","text":"**: 这是一个直接 API 配置示例，展示如何连接到特定模型提供商（如 DeepSeek）。如果您使用其他提供商（如 OpenAI），可以类似地添加配置块。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"apiKey"},{"type":"text","text":"**: "},{"type":"text","marks":[{"type":"bold"}],"text":"敏感信息"},{"type":"text","text":"，请务必妥善保管。您也可以通过设置环境变量 "},{"type":"text","marks":[{"type":"code"}],"text":"NANOBOT_PROVIDERS_OPENROUTER_APIKEY"},{"type":"text","text":" 来注入，避免写入配置文件。"}]},{"type":"paragraph","content":[{"type":"text","text":"#### 2. "},{"type":"text","marks":[{"type":"code"}],"text":"agents"},{"type":"text","text":" (Agent 默认行为配置)"}]},{"type":"paragraph","content":[{"type":"text","text":"这里定义了机器人的默认工作方式。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"model"},{"type":"text","text":"**: 指定默认使用的模型。如果配置了多个 "},{"type":"text","marks":[{"type":"code"}],"text":"providers"},{"type":"text","text":"，nanobot 会根据模型名称自动匹配对应的提供商。例如"},{"type":"text","marks":[{"type":"code"}],"text":"anthropic/..."},{"type":"text","text":" 会通过 OpenRouter 路由，而 "},{"type":"text","marks":[{"type":"code"}],"text":"deepseek-chat"},{"type":"text","text":" 会通过 "},{"type":"text","marks":[{"type":"code"}],"text":"deepseek"},{"type":"text","text":" 提供商。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"tools.restrictToWorkspace"},{"type":"text","text":"**: "},{"type":"text","marks":[{"type":"bold"}],"text":"安全关键"},{"type":"text","text":"。设置为 "},{"type":"text","marks":[{"type":"code"}],"text":"true"},{"type":"text","text":" 后，机器人所有的文件操作工具都会被限制在 "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot/workspace/"},{"type":"text","text":" 目录内，防止其误操作或恶意修改您系统上的其他文件。"}]},{"type":"paragraph","content":[{"type":"text","text":"#### 3. "},{"type":"text","marks":[{"type":"code"}],"text":"channels"},{"type":"text","text":" (聊天渠道配置) - 您的核心需求"}]},{"type":"paragraph","content":[{"type":"text","text":"这是连接用户与机器人的桥梁。"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"Telegram 配置"},{"type":"text","text":"："}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"enabled"},{"type":"text","text":"**: 设置为 "},{"type":"text","marks":[{"type":"code"}],"text":"true"},{"type":"text","text":" 以启用此渠道。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"token"},{"type":"text","text":"**: 您的 Telegram Bot Token。您需要在 Telegram 中与 [@BotFather]("},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://t.me/botfather","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"https://t.me/botfather"},{"type":"text","text":") 对话，按照 "},{"type":"text","marks":[{"type":"code"}],"text":"/newbot"},{"type":"text","text":" 指令创建一个机器人并获取 Token。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"allowFrom"},{"type":"text","text":"**: "},{"type":"text","marks":[{"type":"bold"}],"text":"安全白名单"},{"type":"text","text":"。填写您的 Telegram 用户 ID（可以通过 [@userinfobot]("},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://t.me/userinfobot","target":"_blank","rel":"noopener noreferrer nofollow","class":null}}],"text":"https://t.me/userinfobot"},{"type":"text","text":") 获取）。这样设置后，**只有您**能与这个机器人对话，防止他人滥用。如果想公开使用，可以将其留空 "},{"type":"text","marks":[{"type":"code"}],"text":"[]"},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"bold"}],"text":"Email 配置"},{"type":"text","text":"："}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"enabled"},{"type":"text","text":"**: 设置为 "},{"type":"text","marks":[{"type":"code"}],"text":"true"},{"type":"text","text":" 以启用此渠道。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"consentGranted"},{"type":"text","text":"**: 必须设置为 "},{"type":"text","marks":[{"type":"code"}],"text":"true"},{"type":"text","text":"，表示您授权机器人访问您的邮箱收发邮件。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"imap*"},{"type":"text","text":" / "},{"type":"text","marks":[{"type":"code"}],"text":"smtp*"},{"type":"text","text":"**: 分别是接收和发送邮件的服务器设置。以上示例是 Gmail 的配置，如果您使用其他邮箱服务（如 Outlook, QQ邮箱等），请查询并修改相应的服务器地址、端口。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"imapPassword"},{"type":"text","text":" / "},{"type":"text","marks":[{"type":"code"}],"text":"smtpPassword"},{"type":"text","text":"**: "},{"type":"text","marks":[{"type":"bold"}],"text":"安全建议"},{"type":"text","text":"。对于 Gmail 等现代邮箱服务，不应使用您的账户登录密码，而应为其生成一个**应用专用密码**，并在邮箱设置中开启 IMAP/SMTP 服务。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"fromAddress"},{"type":"text","text":"**: 机器人回复邮件时，将显示的发件人地址。"}]},{"type":"paragraph","content":[{"type":"text","text":"- *"},{"type":"text","marks":[{"type":"code"}],"text":"allowFrom"},{"type":"text","text":"**: 邮件发件人白名单。只有在这个列表中的邮箱发来的邮件，机器人才会处理。如果留空 "},{"type":"text","marks":[{"type":"code"}],"text":"[]"},{"type":"text","text":"，则会处理所有收到的邮件。"}]},{"type":"paragraph","content":[{"type":"text","text":"#### 4. "},{"type":"text","marks":[{"type":"code"}],"text":"gateway"},{"type":"text","text":" (网关服务配置)"}]},{"type":"paragraph","content":[{"type":"text","text":"- 当您运行 "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot gateway"},{"type":"text","text":" 命令时，会启动这个服务。它负责监听所有已启用的渠道（本例中是 Telegram 和 Email），并将消息统一路由给 AI Agent 处理。通常保持默认配置即可。"}]},{"type":"paragraph","content":[{"type":"text","text":"#### 5. "},{"type":"text","marks":[{"type":"code"}],"text":"tools"},{"type":"text","text":" (工具安全配置)"}]},{"type":"paragraph","content":[{"type":"text","text":"- 这是一个全局设置，与 "},{"type":"text","marks":[{"type":"code"}],"text":"agents.defaults.tools.restrictToWorkspace"},{"type":"text","text":" 功能类似，确保所有工具的执行都在安全沙盒内。双重保险，建议开启。"}]},{"type":"paragraph","content":[{"type":"text","text":"### 使用步骤简述"}]},{"type":"paragraph","content":[{"type":"text","text":"1. "},{"type":"text","marks":[{"type":"bold"}],"text":"创建配置文件"},{"type":"text","text":": 按照上述示例，将您的真实信息填入，并保存为 "},{"type":"text","marks":[{"type":"code"}],"text":"~/.nanobot/config.json"},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"2. "},{"type":"text","marks":[{"type":"bold"}],"text":"启动网关"},{"type":"text","text":": 在终端中运行 "},{"type":"text","marks":[{"type":"code"}],"text":"nanobot gateway"},{"type":"text","text":"。"}]},{"type":"paragraph","content":[{"type":"text","text":"3. "},{"type":"text","marks":[{"type":"bold"}],"text":"开始使用"},{"type":"text","text":":"}]},{"type":"paragraph","content":[{"type":"text","text":"* 在 Telegram 中找到您创建的机器人，发送消息。"}]},{"type":"paragraph","content":[{"type":"text","text":"* 向您配置的邮箱地址发送一封邮件。"}]},{"type":"paragraph","content":[{"type":"text","text":"机器人将根据您的配置，通过相应的渠道回复您。如果您是第一次使用，建议先只用 Telegram 渠道进行测试，确保工作正常后再配置 Email 渠道。"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":3,"id":"Nvidia-api"},"content":[{"type":"text","text":"Nvidia api"}]},{"type":"paragraph","content":[{"type":"text","text":"大模型配置"}]},{"type":"codeBlock","attrs":{"language":null},"content":[{"type":"text","text":"\"providers\": {\n        \"openai\": {\n            \"apiKey\": \"nvapi-vCqKOJQgt237*\",\n            \"baseUrl\": \"https://integrate.api.nvidia.com/v1\"\n        }\n    },\n    \"agents\": {\n        \"defaults\": {\n            \"model\": \"nvidia/openai/gpt-oss-120b\",\n            \"temperature\": 0.6,\n            \"max_tokens\": 256\n        }\n    },\n\nerror ╭─ 🐈 nanobot ───────────────────────────────────────────╮\n│ Error calling LLM: litellm.BadRequestError: LLM        │\n│ Provider NOT provided. Pass in the LLM provider you    │\n│ are trying to call. You passed                         │\n│ model=nvidia/openai/gpt-oss-120b Pass model as E.g.    │\n│ For 'Huggingface' inference endpoints pass in          │\n│ completion(model='huggingface/starcoder',..) Learn     │\n│ more: https://docs.litellm.ai/docs/providers"}]},{"type":"paragraph","content":[{"type":"text","text":"默认模型那个地方这么改"},{"type":"hardBreak"},{"type":"text","text":"”\"agents\": {"},{"type":"hardBreak"},{"type":"text","text":"\"defaults\": {"},{"type":"hardBreak"},{"type":"text","text":"\"workspace\": \"~/.nanobot/workspace\","},{"type":"hardBreak"},{"type":"text","text":"\"model\": \"openai/minimaxai/minimax-m2.1\","},{"type":"hardBreak"},{"type":"text","text":"..."},{"type":"hardBreak"},{"type":"text","text":"}"},{"type":"hardBreak"},{"type":"text","text":"},"}]},{"type":"paragraph","content":[{"type":"text","text":"主要就是” \"model\": \"openai/minimaxai/minimax-m2.1\",“"}]},{"type":"paragraph","content":[{"type":"text","text":"这个方式是正确的，模型添加openai前缀即可"}]},{"type":"paragraph"},{"type":"paragraph"}]}